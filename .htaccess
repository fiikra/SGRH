# === Global Security: Prevent Directory Listing ===
Options -Indexes

# === Deny Access to .env, config, and sensitive files ===
<FilesMatch "^(\.env|\.git|\.ht|composer\.json|composer\.lock|package\.json|package-lock\.json|yarn\.lock|config\.php|database\.php|.*\.bak|.*\.sql)$">
    Require all denied
</FilesMatch>

# === Block access to hidden files and folders (dotfiles) ===
RedirectMatch 404 /\..*

# === Prevent access to includes, config, and lib folders ===
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteRule ^(includes|config|lib|private|core|vendor)/ - [F,L,NC]
</IfModule>

# === XSS Protection and MIME Sniffing ===
Header set X-Content-Type-Options "nosniff"
Header set X-XSS-Protection "1; mode=block"
Header set Referrer-Policy "strict-origin-when-cross-origin"

# === Clickjacking Protection ===
Header always set X-Frame-Options "DENY"

# === HSTS (HTTPS only, uncomment if site is HTTPS) ===
# Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"

# === Content Security Policy (CSP) Example - adjust for your assets ===
Header set Content-Security-Policy "default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; img-src 'self' data:; font-src 'self' https://cdn.jsdelivr.net;"

# === Disable TRACE/TRACK methods ===
# ===TraceEnable off   add this in httpd config on windows xammp or wamp !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
RewriteCond %{REQUEST_METHOD} ^(TRACE|TRACK)
RewriteRule .* - [F]

# === Prevent HTTP Response Splitting ===
Header edit Set-Cookie ^(.*)$ $1;HttpOnly;Secure;SameSite=Strict

# === Prevent ETag header (can leak file info) ===
FileETag None

# === Prevent Browsing of the root if no index file ===
DirectoryIndex index.php index.html 

# === Protect .htaccess itself ===
<Files .htaccess>
    Require all denied
</Files>